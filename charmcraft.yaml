# Copyright 2025 Canonical Ltd.
# See LICENSE file for licensing details.

name: git-ubuntu
title: Git-Ubuntu Package Importer Charm
summary: A charm for deploying git-ubuntu for package importing.
description: |
  **Git-Ubuntu Operator** is a [charm](https://juju.is/charms-architecture)
  that deploys [git-ubuntu](https://launchpad.net/git-ubuntu) for importing and
  publishing git histories associated with Ubuntu packages.

type: charm
base: ubuntu@24.04
platforms:
  amd64:

parts:
  git-ubuntu-charm:
    plugin: charm
    source: .

charm-libs:
  - lib: operator-libs-linux.apt
    version: "0"
  - lib: operator-libs-linux.snap
    version: "2"

config:
  options:
    channel:
      description: |
        Channel for the git-ubuntu snap.
      default: "beta"
      type: string
    lpuser:
      description: |
        Launchpad user used to push updates to the official git repositories.
        This user must be a member of ~git-ubuntu-import.
      default: "git-ubuntu-bot"
      type: string
    workers:
      description: |
        The number of git-ubuntu worker processes to maintain.
      default: 2
      type: int
    primary:
      description: |
        If this is the primary git-ubuntu importer node, containing the Broker
        and Poller instances. Non-primary nodes will only contain Worker
        instances.
      default: True
      type: boolean
    data_directory:
      description: |
        The directory to store state information in, including the sqlite
        database for broker-poller interactions. This setting is only
        relevant when primary is True.
      default: "/var/local/git-ubuntu"
      type: string
    source_directory:
      description: |
        The directory to download the git-ubuntu source in. The included source
        is used to provide the package denylist to the poller.
      default: "/home/ubuntu"
      type: string
